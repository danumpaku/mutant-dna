AWSTemplateFormatVersion: "2010-09-09"
Description: >
  Creates a database connection secret with auto-generated password
Parameters:
  SecretName:
    Type: String
  Username:
    Type: String
Resources:
  DatabaseSecret:
    Type: AWS::SecretsManager::Secret
    Properties:
      Description: !Ref SecretName
      Name: !Ref SecretName
      GenerateSecretString:
        SecretStringTemplate: !Sub '{"username": "${Username}"}'
        GenerateStringKey: 'password'
        PasswordLength: 16
        ExcludeCharacters: '"@/\'
      Tags:
        - Key: 'SecretName'
          Value: !Ref SecretName
Outputs:
  DatabaseSecretArn:
    Value: !Ref DatabaseSecret